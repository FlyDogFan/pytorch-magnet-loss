I got allocated the
/var/spool/torque/mom_priv/jobs/81669.blindspot.SC: line 15: following: command not found
gpu: 2
PBS: qsub is running on focus
PBS: originating queue is batch
PBS: executing queue is batch
PBS: working directory is /z/home/mbanani/projects/pytorch-magnet-loss
PBS: execution mode is PBS_BATCH
PBS: job identifich_convAtter is 81669.blindspot
PBS: job name is magnet_loss_train_Pets
PBS: node file is /var/spool/torque/aux//81669.blindspot
PBS: current home directory is /home/mbanani
PBS: PATH = /z/home/mbanani/PyTorch3/bin:/z/sw/packages/cuda/8.0.61/bin:/z/home/mbanani/sw/miniconda2/bin:/z/sw/bin/:/z/sw/sbin/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
------------------------------------------------------
Namespace(D=4, GAP=2.43, K=1, L=8, M=12, NUM_BATCHES=100, annealing_factor=1.0, dataset='flowers', dist_backend='gloo', dist_url='tcp://224.66.41.62:23456', embedding_size=256, eval_epoch=3, eval_step=1000, evaluate_only=False, evaluate_train=False, experiment_name='MagnetTest', log_rate=10, loss='magnet', lr=0.024, model='inception', momentum=0.9, num_epochs=100, optimizer='sgd', resume=None, save_epoch=10, weight_decay=0.0001, workers=7, world_size=1)

Experiment path is :  /z/home/mbanani/projects/pytorch-magnet-loss/experiments/flowers/exp_04_17_18_44_01_flowers_MagnetTest
#############  Read in Database   ##############
Generating Datasets
csv file length:  1019
Dataset loaded in  0.0026464462280273438  secs.
Dataset size:  1019
csv file length:  1019
Dataset loaded in  0.002006053924560547  secs.
Dataset size:  1019
Generating Data Loaders
Time taken:  0.004862546920776367 seconds
######## Initiate Model and Optimizer   ##############
Time taken:  6.846621990203857 seconds
#############  Start Training     ##############
KNN: Forward Pass Time   5.294
KNN: Clustering time     0.592
Number of proper clusters: 102
train_magnet.py:444: RuntimeWarning: invalid value encountered in true_divide
  loss_vector = loss_vector / np.sum(loss_vector)
train_magnet.py:407: RuntimeWarning: invalid value encountered in less
  M0 = np.random.choice(range(0, num_clusters), p = loss_vector)
Epoch: [0][10/17]	Time 0.732 (0.785)	Data 0.000 (0.078)	Loss 4.8256 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.772)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.687)
Test: 	Time 0.697	Prec@1 32.475	Prec@5 58.088
KNN: Forward Pass Time   3.100
KNN: Clustering time     0.149
Number of proper clusters: 102
/z/home/mbanani/PyTorch3/lib/python3.5/site-packages/sklearn/cluster/k_means_.py:896: RuntimeWarning: Explicit initial center position passed: performing only one init in k-means instead of n_init=10
  return_n_iter=True)
Epoch: [1][10/16]	Time 0.765 (0.779)	Data 0.000 (0.086)	Loss 4.8255 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.643)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.530)
Test: 	Time 0.536	Prec@1 64.583	Prec@5 85.547
KNN: Forward Pass Time   3.095
KNN: Clustering time     0.112
Number of proper clusters: 102
Epoch: [2][10/16]	Time 0.688 (0.791)	Data 0.000 (0.085)	Loss 4.8255 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.651)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.505)
Test: 	Time 0.513	Prec@1 63.151	Prec@5 85.026
KNN: Forward Pass Time   3.179
KNN: Clustering time     0.089
Number of proper clusters: 102
Epoch: [3][10/16]	Time 0.689 (0.758)	Data 0.000 (0.088)	Loss 4.8256 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.830)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.514)
Test: 	Time 0.521	Prec@1 65.625	Prec@5 85.547
KNN: Forward Pass Time   3.093
KNN: Clustering time     0.102
Number of proper clusters: 102
Epoch: [4][10/16]	Time 0.804 (0.778)	Data 0.000 (0.080)	Loss 4.8252 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.866)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.519)
Test: 	Time 0.526	Prec@1 65.495	Prec@5 85.286
KNN: Forward Pass Time   3.176
KNN: Clustering time     0.111
Number of proper clusters: 102
Epoch: [5][10/16]	Time 0.708 (0.784)	Data 0.000 (0.088)	Loss 4.8255 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.834)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.685)
Test: 	Time 0.694	Prec@1 63.411	Prec@5 86.589
KNN: Forward Pass Time   3.281
KNN: Clustering time     0.102
Number of proper clusters: 102
Epoch: [6][10/16]	Time 0.708 (0.795)	Data 0.000 (0.085)	Loss 4.8253 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.861)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.616)
Test: 	Time 0.625	Prec@1 63.542	Prec@5 83.073
KNN: Forward Pass Time   3.297
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [7][10/16]	Time 0.736 (0.794)	Data 0.000 (0.080)	Loss 4.8258 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.853)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.662)
Test: 	Time 0.671	Prec@1 62.240	Prec@5 85.677
KNN: Forward Pass Time   3.231
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [8][10/16]	Time 0.683 (0.734)	Data 0.000 (0.080)	Loss 4.8255 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.823)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.630)
Test: 	Time 0.638	Prec@1 62.760	Prec@5 84.375
KNN: Forward Pass Time   3.318
KNN: Clustering time     0.111
Number of proper clusters: 102
Epoch: [9][10/16]	Time 0.692 (0.787)	Data 0.000 (0.087)	Loss 4.8256 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.753)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.607)
Test: 	Time 0.617	Prec@1 67.839	Prec@5 85.807
KNN: Forward Pass Time   3.197
KNN: Clustering time     0.092
Number of proper clusters: 102
Epoch: [10][10/16]	Time 0.699 (0.770)	Data 0.000 (0.072)	Loss 4.8253 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.803)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.531)
Test: 	Time 0.538	Prec@1 64.714	Prec@5 86.068
KNN: Forward Pass Time   3.151
KNN: Clustering time     0.148
Number of proper clusters: 102
Epoch: [11][10/16]	Time 0.707 (0.800)	Data 0.000 (0.095)	Loss 4.8256 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.932)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.474)
Test: 	Time 0.481	Prec@1 65.755	Prec@5 87.760
KNN: Forward Pass Time   3.245
KNN: Clustering time     0.138
Number of proper clusters: 102
Epoch: [12][10/16]	Time 0.667 (0.778)	Data 0.000 (0.082)	Loss 4.8259 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.888)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.566)
Test: 	Time 0.573	Prec@1 61.979	Prec@5 86.068
KNN: Forward Pass Time   3.186
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [13][10/16]	Time 0.688 (0.777)	Data 0.000 (0.084)	Loss 4.8256 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.829)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.653)
Test: 	Time 0.662	Prec@1 63.151	Prec@5 86.198
KNN: Forward Pass Time   3.296
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [14][10/16]	Time 0.686 (0.779)	Data 0.000 (0.093)	Loss 4.8253 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.848)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.512)
Test: 	Time 0.519	Prec@1 63.542	Prec@5 85.417
KNN: Forward Pass Time   3.176
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [15][10/16]	Time 0.688 (0.792)	Data 0.000 (0.087)	Loss 4.8256 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.712)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.545)
Test: 	Time 0.553	Prec@1 65.365	Prec@5 85.677
KNN: Forward Pass Time   3.272
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [16][10/16]	Time 0.725 (0.812)	Data 0.000 (0.092)	Loss 4.8256 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.725)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.517)
Test: 	Time 0.524	Prec@1 63.021	Prec@5 85.286
KNN: Forward Pass Time   3.329
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [17][10/16]	Time 0.744 (0.776)	Data 0.000 (0.074)	Loss 4.8253 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.818)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.517)
Test: 	Time 0.524	Prec@1 64.974	Prec@5 84.115
KNN: Forward Pass Time   3.299
KNN: Clustering time     0.123
Number of proper clusters: 102
Epoch: [18][10/16]	Time 0.704 (0.784)	Data 0.000 (0.078)	Loss 4.8254 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.841)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.526)
Test: 	Time 0.532	Prec@1 63.151	Prec@5 86.068
KNN: Forward Pass Time   3.290
KNN: Clustering time     0.111
Number of proper clusters: 102
Epoch: [19][10/16]	Time 0.707 (0.794)	Data 0.000 (0.087)	Loss 4.8256 (4.8257)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.723)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.490)
Test: 	Time 0.497	Prec@1 64.062	Prec@5 85.547
KNN: Forward Pass Time   3.302
KNN: Clustering time     0.153
Number of proper clusters: 102
Epoch: [20][10/16]	Time 0.700 (0.786)	Data 0.000 (0.079)	Loss 4.8256 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.845)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.501)
Test: 	Time 0.508	Prec@1 67.188	Prec@5 87.240
KNN: Forward Pass Time   3.357
KNN: Clustering time     0.094
Number of proper clusters: 102
Epoch: [21][10/16]	Time 0.718 (0.781)	Data 0.000 (0.083)	Loss 4.8252 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.938)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.504)
Test: 	Time 0.511	Prec@1 64.193	Prec@5 84.505
KNN: Forward Pass Time   3.185
KNN: Clustering time     0.094
Number of proper clusters: 102
Epoch: [22][10/16]	Time 0.706 (0.798)	Data 0.000 (0.084)	Loss 4.8256 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.830)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.656)
Test: 	Time 0.665	Prec@1 64.323	Prec@5 86.328
KNN: Forward Pass Time   3.260
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [23][10/16]	Time 0.710 (0.767)	Data 0.000 (0.084)	Loss 4.8255 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.901)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.490)
Test: 	Time 0.497	Prec@1 62.109	Prec@5 83.203
KNN: Forward Pass Time   3.165
KNN: Clustering time     0.099
Number of proper clusters: 102
Epoch: [24][10/16]	Time 0.744 (0.782)	Data 0.000 (0.085)	Loss 4.8257 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.801)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.531)
Test: 	Time 0.538	Prec@1 65.755	Prec@5 86.328
KNN: Forward Pass Time   3.295
KNN: Clustering time     0.094
Number of proper clusters: 102
Epoch: [25][10/16]	Time 0.721 (0.800)	Data 0.000 (0.091)	Loss 4.8253 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.841)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.475)
Test: 	Time 0.481	Prec@1 63.672	Prec@5 85.026
KNN: Forward Pass Time   3.319
KNN: Clustering time     0.142
Number of proper clusters: 102
Epoch: [26][10/16]	Time 0.705 (0.780)	Data 0.000 (0.075)	Loss 4.8256 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.840)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.671)
Test: 	Time 0.680	Prec@1 64.323	Prec@5 85.026
KNN: Forward Pass Time   3.200
KNN: Clustering time     0.104
Number of proper clusters: 102
Epoch: [27][10/16]	Time 0.635 (0.710)	Data 0.000 (0.081)	Loss 4.8252 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.879)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.489)
Test: 	Time 0.495	Prec@1 63.411	Prec@5 85.807
KNN: Forward Pass Time   3.218
KNN: Clustering time     0.114
Number of proper clusters: 102
Epoch: [28][10/16]	Time 0.720 (0.782)	Data 0.000 (0.082)	Loss 4.8255 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.884)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.504)
Test: 	Time 0.510	Prec@1 64.583	Prec@5 84.375
KNN: Forward Pass Time   3.336
KNN: Clustering time     0.098
Number of proper clusters: 102
Epoch: [29][10/16]	Time 0.690 (0.784)	Data 0.000 (0.086)	Loss 4.8251 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.682)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.567)
Test: 	Time 0.573	Prec@1 60.938	Prec@5 85.807
KNN: Forward Pass Time   3.323
KNN: Clustering time     0.095
Number of proper clusters: 102
Epoch: [30][10/16]	Time 0.677 (0.784)	Data 0.000 (0.079)	Loss 4.8254 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.924)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.563)
Test: 	Time 0.570	Prec@1 61.589	Prec@5 85.286
KNN: Forward Pass Time   3.315
KNN: Clustering time     0.109
Number of proper clusters: 102
Epoch: [31][10/16]	Time 0.755 (0.774)	Data 0.000 (0.090)	Loss 4.8257 (4.8256)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.917)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.466)
Test: 	Time 0.472	Prec@1 63.151	Prec@5 86.589
KNN: Forward Pass Time   3.425
KNN: Clustering time     0.095
Number of proper clusters: 102
Epoch: [32][10/16]	Time 0.742 (0.782)	Data 0.000 (0.076)	Loss 4.8253 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.788)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.679)
Test: 	Time 0.687	Prec@1 65.495	Prec@5 87.109
KNN: Forward Pass Time   3.285
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [33][10/16]	Time 0.702 (0.789)	Data 0.000 (0.083)	Loss 4.8255 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.837)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.761)
Test: 	Time 0.771	Prec@1 61.979	Prec@5 84.896
KNN: Forward Pass Time   3.219
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [34][10/16]	Time 0.704 (0.784)	Data 0.000 (0.078)	Loss 4.8256 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.914)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.725)
Test: 	Time 0.735	Prec@1 65.885	Prec@5 85.156
KNN: Forward Pass Time   3.283
KNN: Clustering time     0.111
Number of proper clusters: 102
Epoch: [35][10/16]	Time 0.778 (0.772)	Data 0.000 (0.076)	Loss 4.8254 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.835)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.484)
Test: 	Time 0.490	Prec@1 64.844	Prec@5 83.203
KNN: Forward Pass Time   3.403
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [36][10/16]	Time 0.745 (0.772)	Data 0.000 (0.081)	Loss 4.8254 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.957)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.486)
Test: 	Time 0.493	Prec@1 63.281	Prec@5 83.854
KNN: Forward Pass Time   3.191
KNN: Clustering time     0.160
Number of proper clusters: 102
Epoch: [37][10/16]	Time 0.714 (0.784)	Data 0.000 (0.082)	Loss 4.8257 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.933)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.490)
Test: 	Time 0.497	Prec@1 65.885	Prec@5 85.286
KNN: Forward Pass Time   3.147
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [38][10/16]	Time 0.692 (0.772)	Data 0.000 (0.074)	Loss 4.8253 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.810)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.475)
Test: 	Time 0.481	Prec@1 63.802	Prec@5 86.328
KNN: Forward Pass Time   3.176
KNN: Clustering time     0.150
Number of proper clusters: 102
Epoch: [39][10/16]	Time 0.704 (0.806)	Data 0.000 (0.095)	Loss 4.8254 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.716)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.601)
Test: 	Time 0.610	Prec@1 65.104	Prec@5 86.198
KNN: Forward Pass Time   3.343
KNN: Clustering time     0.123
Number of proper clusters: 102
Epoch: [40][10/16]	Time 0.711 (0.785)	Data 0.000 (0.090)	Loss 4.8252 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.791)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.564)
Test: 	Time 0.573	Prec@1 66.406	Prec@5 86.068
KNN: Forward Pass Time   3.266
KNN: Clustering time     0.099
Number of proper clusters: 102
Epoch: [41][10/16]	Time 0.708 (0.785)	Data 0.000 (0.086)	Loss 4.8251 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.745)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.617)
Test: 	Time 0.624	Prec@1 64.974	Prec@5 87.760
KNN: Forward Pass Time   3.386
KNN: Clustering time     0.099
Number of proper clusters: 102
Epoch: [42][10/16]	Time 0.680 (0.791)	Data 0.000 (0.084)	Loss 4.8252 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.860)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.636)
Test: 	Time 0.644	Prec@1 61.849	Prec@5 83.724
KNN: Forward Pass Time   3.245
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [43][10/16]	Time 0.740 (0.782)	Data 0.000 (0.082)	Loss 4.8253 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.855)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.704)
Test: 	Time 0.713	Prec@1 65.365	Prec@5 87.109
KNN: Forward Pass Time   3.234
KNN: Clustering time     0.116
Number of proper clusters: 102
Epoch: [44][10/16]	Time 0.728 (0.775)	Data 0.000 (0.073)	Loss 4.8255 (4.8255)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.739)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.634)
Test: 	Time 0.643	Prec@1 63.802	Prec@5 84.505
KNN: Forward Pass Time   3.236
KNN: Clustering time     0.146
Number of proper clusters: 102
Epoch: [45][10/16]	Time 0.610 (0.763)	Data 0.000 (0.087)	Loss 4.8252 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.832)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.630)
Test: 	Time 0.639	Prec@1 62.891	Prec@5 84.766
KNN: Forward Pass Time   3.255
KNN: Clustering time     0.114
Number of proper clusters: 102
Epoch: [46][10/16]	Time 0.688 (0.793)	Data 0.000 (0.088)	Loss 4.8254 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.824)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.644)
Test: 	Time 0.653	Prec@1 65.885	Prec@5 86.719
KNN: Forward Pass Time   3.224
KNN: Clustering time     0.124
Number of proper clusters: 102
Epoch: [47][10/16]	Time 0.687 (0.772)	Data 0.000 (0.076)	Loss 4.8252 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.804)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.589)
Test: 	Time 0.595	Prec@1 64.453	Prec@5 85.286
KNN: Forward Pass Time   3.313
KNN: Clustering time     0.130
Number of proper clusters: 102
Epoch: [48][10/16]	Time 0.719 (0.796)	Data 0.000 (0.090)	Loss 4.8252 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.730)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.705)
Test: 	Time 0.714	Prec@1 65.625	Prec@5 86.198
KNN: Forward Pass Time   3.313
KNN: Clustering time     0.144
Number of proper clusters: 102
Epoch: [49][10/16]	Time 0.680 (0.767)	Data 0.000 (0.080)	Loss 4.8254 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.910)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.583)
Test: 	Time 0.592	Prec@1 63.672	Prec@5 85.026
KNN: Forward Pass Time   3.424
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [50][10/16]	Time 0.696 (0.768)	Data 0.000 (0.077)	Loss 4.8252 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.859)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.470)
Test: 	Time 0.476	Prec@1 65.365	Prec@5 85.938
KNN: Forward Pass Time   3.209
KNN: Clustering time     0.110
Number of proper clusters: 102
Epoch: [51][10/16]	Time 0.698 (0.789)	Data 0.000 (0.087)	Loss 4.8252 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.920)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.481)
Test: 	Time 0.488	Prec@1 63.151	Prec@5 83.073
KNN: Forward Pass Time   3.177
KNN: Clustering time     0.101
Number of proper clusters: 102
Epoch: [52][10/16]	Time 0.700 (0.770)	Data 0.000 (0.088)	Loss 4.8258 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.873)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.654)
Test: 	Time 0.663	Prec@1 62.891	Prec@5 85.026
KNN: Forward Pass Time   3.321
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [53][10/16]	Time 0.594 (0.778)	Data 0.000 (0.070)	Loss 4.8256 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.747)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.632)
Test: 	Time 0.641	Prec@1 65.234	Prec@5 85.547
KNN: Forward Pass Time   3.246
KNN: Clustering time     0.110
Number of proper clusters: 102
Epoch: [54][10/16]	Time 0.731 (0.780)	Data 0.000 (0.076)	Loss 4.8255 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.741)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.638)
Test: 	Time 0.647	Prec@1 63.021	Prec@5 84.505
KNN: Forward Pass Time   3.255
KNN: Clustering time     0.090
Number of proper clusters: 102
Epoch: [55][10/16]	Time 0.708 (0.777)	Data 0.000 (0.074)	Loss 4.8251 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.825)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.478)
Test: 	Time 0.486	Prec@1 64.453	Prec@5 85.156
KNN: Forward Pass Time   3.192
KNN: Clustering time     0.147
Number of proper clusters: 102
Epoch: [56][10/16]	Time 0.636 (0.716)	Data 0.000 (0.077)	Loss 4.8251 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.715)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.456)
Test: 	Time 0.463	Prec@1 62.500	Prec@5 86.458
KNN: Forward Pass Time   3.319
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [57][10/16]	Time 0.704 (0.788)	Data 0.000 (0.084)	Loss 4.8254 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.813)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.486)
Test: 	Time 0.492	Prec@1 65.234	Prec@5 86.589
KNN: Forward Pass Time   3.109
KNN: Clustering time     0.109
Number of proper clusters: 102
Epoch: [58][10/16]	Time 0.658 (0.791)	Data 0.000 (0.087)	Loss 4.8251 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.733)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.491)
Test: 	Time 0.498	Prec@1 66.536	Prec@5 86.979
KNN: Forward Pass Time   3.407
KNN: Clustering time     0.090
Number of proper clusters: 102
Epoch: [59][10/16]	Time 0.705 (0.790)	Data 0.000 (0.091)	Loss 4.8252 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.779)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.463)
Test: 	Time 0.470	Prec@1 67.969	Prec@5 84.505
KNN: Forward Pass Time   3.271
KNN: Clustering time     0.148
Number of proper clusters: 102
Epoch: [60][10/16]	Time 0.699 (0.779)	Data 0.000 (0.082)	Loss 4.8254 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.884)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.505)
Test: 	Time 0.512	Prec@1 63.151	Prec@5 84.375
KNN: Forward Pass Time   3.217
KNN: Clustering time     0.130
Number of proper clusters: 102
Epoch: [61][10/16]	Time 0.709 (0.794)	Data 0.000 (0.095)	Loss 4.8252 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.815)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.613)
Test: 	Time 0.619	Prec@1 66.016	Prec@5 85.417
KNN: Forward Pass Time   3.192
KNN: Clustering time     0.118
Number of proper clusters: 102
Epoch: [62][10/16]	Time 0.716 (0.803)	Data 0.000 (0.097)	Loss 4.8248 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.917)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.485)
Test: 	Time 0.492	Prec@1 64.453	Prec@5 84.896
KNN: Forward Pass Time   3.185
KNN: Clustering time     0.133
Number of proper clusters: 102
Epoch: [63][10/16]	Time 0.731 (0.795)	Data 0.000 (0.080)	Loss 4.8248 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.965)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.615)
Test: 	Time 0.623	Prec@1 66.146	Prec@5 86.068
KNN: Forward Pass Time   3.269
KNN: Clustering time     0.110
Number of proper clusters: 102
Epoch: [64][10/16]	Time 0.672 (0.798)	Data 0.000 (0.092)	Loss 4.8254 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.836)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.470)
Test: 	Time 0.477	Prec@1 64.453	Prec@5 83.854
KNN: Forward Pass Time   3.115
KNN: Clustering time     0.144
Number of proper clusters: 102
Epoch: [65][10/16]	Time 0.677 (0.792)	Data 0.000 (0.091)	Loss 4.8253 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.810)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.714)
Test: 	Time 0.722	Prec@1 62.891	Prec@5 86.458
KNN: Forward Pass Time   3.324
KNN: Clustering time     0.112
Number of proper clusters: 102
Epoch: [66][10/16]	Time 0.713 (0.781)	Data 0.000 (0.081)	Loss 4.8255 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.859)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.670)
Test: 	Time 0.678	Prec@1 65.234	Prec@5 86.458
KNN: Forward Pass Time   3.343
KNN: Clustering time     0.120
Number of proper clusters: 102
Epoch: [67][10/16]	Time 0.703 (0.779)	Data 0.000 (0.092)	Loss 4.8250 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.792)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.500)
Test: 	Time 0.512	Prec@1 63.542	Prec@5 84.896
KNN: Forward Pass Time   3.266
KNN: Clustering time     0.146
Number of proper clusters: 102
Epoch: [68][10/16]	Time 0.675 (0.778)	Data 0.000 (0.081)	Loss 4.8256 (4.8254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.767)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.655)
Test: 	Time 0.664	Prec@1 64.974	Prec@5 85.677
KNN: Forward Pass Time   3.181
KNN: Clustering time     0.165
Number of proper clusters: 102
Epoch: [69][10/16]	Time 0.715 (0.816)	Data 0.000 (0.099)	Loss 4.8252 (4.8252)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.839)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.462)
Test: 	Time 0.468	Prec@1 65.885	Prec@5 86.719
KNN: Forward Pass Time   3.196
KNN: Clustering time     0.111
Number of proper clusters: 102
Epoch: [70][10/16]	Time 0.710 (0.798)	Data 0.000 (0.093)	Loss 4.8254 (4.8252)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.871)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.768)
Test: 	Time 0.777	Prec@1 62.500	Prec@5 84.375
KNN: Forward Pass Time   3.204
KNN: Clustering time     0.132
Number of proper clusters: 102
Epoch: [71][10/16]	Time 0.703 (0.801)	Data 0.000 (0.092)	Loss 4.8252 (4.8252)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.783)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.476)
Test: 	Time 0.482	Prec@1 63.281	Prec@5 84.375
KNN: Forward Pass Time   3.180
KNN: Clustering time     0.169
Number of proper clusters: 102
Epoch: [72][10/16]	Time 0.691 (0.774)	Data 0.000 (0.079)	Loss 4.8250 (4.8252)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.829)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.466)
Test: 	Time 0.472	Prec@1 63.281	Prec@5 84.766
KNN: Forward Pass Time   3.419
KNN: Clustering time     0.154
Number of proper clusters: 102
Epoch: [73][10/16]	Time 0.651 (0.746)	Data 0.000 (0.092)	Loss 4.8252 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.707)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.498)
Test: 	Time 0.505	Prec@1 65.104	Prec@5 85.547
KNN: Forward Pass Time   3.276
KNN: Clustering time     0.144
Number of proper clusters: 102
Epoch: [74][10/16]	Time 0.712 (0.780)	Data 0.000 (0.084)	Loss 4.8251 (4.8253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.748)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.469)
Test: 	Time 0.476	Prec@1 64.323	Prec@5 85.026
KNN: Forward Pass Time   3.122
KNN: Clustering time     0.105
Number of proper clusters: 102
Epoch: [75][10/16]	Time 0.725 (0.786)	Data 0.000 (0.084)	Loss 4.8248 (4.8253)	
train_magnet.py:197: RuntimeWarning: overflow encountered in add
  loss_count  += c_loss_count
Evaluation: Forward Embedding Calculation (Time Elapsed 2.757)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.473)
Test: 	Time 0.480	Prec@1 63.281	Prec@5 82.161
KNN: Forward Pass Time   3.409
KNN: Clustering time     0.123
Number of proper clusters: 102
train_magnet.py:398: RuntimeWarning: invalid value encountered in true_divide
  loss_vector = loss_vector / sum(loss_vector)
Evaluation: Forward Embedding Calculation (Time Elapsed 1.261)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.078)
Test: 	Time 0.079	Prec@1 53.125	Prec@5 81.250
KNN: Forward Pass Time   3.353
KNN: Clustering time     0.111
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.230)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.092)
Test: 	Time 0.093	Prec@1 53.125	Prec@5 79.167
KNN: Forward Pass Time   3.201
KNN: Clustering time     0.105
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.233)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.065)
Test: 	Time 0.066	Prec@1 60.417	Prec@5 79.167
KNN: Forward Pass Time   3.282
KNN: Clustering time     0.115
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.105)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.099)
Test: 	Time 0.100	Prec@1 50.000	Prec@5 83.333
KNN: Forward Pass Time   3.351
KNN: Clustering time     0.107
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.079)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.115)
Test: 	Time 0.116	Prec@1 52.083	Prec@5 82.292
KNN: Forward Pass Time   3.313
KNN: Clustering time     0.109
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.264)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.120)
Test: 	Time 0.122	Prec@1 57.292	Prec@5 80.208
KNN: Forward Pass Time   3.247
KNN: Clustering time     0.115
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.172)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.083)
Test: 	Time 0.085	Prec@1 58.333	Prec@5 80.208
KNN: Forward Pass Time   3.199
KNN: Clustering time     0.121
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.251)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.120)
Test: 	Time 0.122	Prec@1 64.583	Prec@5 89.583
KNN: Forward Pass Time   3.159
KNN: Clustering time     0.105
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.253)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.118)
Test: 	Time 0.119	Prec@1 48.958	Prec@5 82.292
KNN: Forward Pass Time   3.142
KNN: Clustering time     0.094
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.193)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.119)
Test: 	Time 0.120	Prec@1 63.542	Prec@5 87.500
KNN: Forward Pass Time   3.223
KNN: Clustering time     0.140
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.147)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.156)
Test: 	Time 0.157	Prec@1 53.125	Prec@5 83.333
KNN: Forward Pass Time   3.335
KNN: Clustering time     0.150
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.145)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.080)
Test: 	Time 0.081	Prec@1 47.917	Prec@5 80.208
KNN: Forward Pass Time   3.191
KNN: Clustering time     0.129
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.228)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.081)
Test: 	Time 0.082	Prec@1 57.292	Prec@5 78.125
KNN: Forward Pass Time   3.237
KNN: Clustering time     0.139
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.256)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.081)
Test: 	Time 0.082	Prec@1 56.250	Prec@5 85.417
KNN: Forward Pass Time   3.278
KNN: Clustering time     0.104
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.232)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.080)
Test: 	Time 0.081	Prec@1 63.542	Prec@5 88.542
KNN: Forward Pass Time   3.168
KNN: Clustering time     0.097
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.128)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.111)
Test: 	Time 0.112	Prec@1 61.458	Prec@5 87.500
KNN: Forward Pass Time   3.302
KNN: Clustering time     0.104
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.189)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.080)
Test: 	Time 0.081	Prec@1 53.125	Prec@5 86.458
KNN: Forward Pass Time   3.306
KNN: Clustering time     0.096
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.307)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.081)
Test: 	Time 0.082	Prec@1 57.292	Prec@5 81.250
KNN: Forward Pass Time   3.328
KNN: Clustering time     0.097
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.154)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.117)
Test: 	Time 0.118	Prec@1 54.167	Prec@5 83.333
KNN: Forward Pass Time   3.125
KNN: Clustering time     0.162
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.196)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.135)
Test: 	Time 0.137	Prec@1 50.000	Prec@5 80.208
KNN: Forward Pass Time   3.240
KNN: Clustering time     0.104
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.239)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.072)
Test: 	Time 0.073	Prec@1 48.958	Prec@5 83.333
KNN: Forward Pass Time   3.182
KNN: Clustering time     0.146
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.216)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.080)
Test: 	Time 0.081	Prec@1 56.250	Prec@5 82.292
KNN: Forward Pass Time   3.392
KNN: Clustering time     0.100
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.292)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.095)
Test: 	Time 0.096	Prec@1 56.250	Prec@5 83.333
KNN: Forward Pass Time   3.178
KNN: Clustering time     0.111
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.176)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.149)
Test: 	Time 0.150	Prec@1 59.375	Prec@5 86.458
KNN: Forward Pass Time   3.210
KNN: Clustering time     0.098
Done
