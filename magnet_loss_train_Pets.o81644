I got allocated the
/var/spool/torque/mom_priv/jobs/81644.blindspot.SC: line 15: following: command not found
gpu: 0
PBS: qsub is running on focus
PBS: originating queue is batch
PBS: executing queue is batch
PBS: working directory is /z/home/mbanani/projects/pytorch-magnet-loss
PBS: execution mode is PBS_BATCH
PBS: job identifich_convAtter is 81644.blindspot
PBS: job name is magnet_loss_train_Pets
PBS: node file is /var/spool/torque/aux//81644.blindspot
PBS: current home directory is /home/mbanani
PBS: PATH = /z/home/mbanani/PyTorch3/bin:/z/sw/packages/cuda/8.0.61/bin:/z/home/mbanani/sw/miniconda2/bin:/z/sw/bin/:/z/sw/sbin/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
------------------------------------------------------
Namespace(D=4, GAP=2.43, K=1, L=8, M=12, NUM_BATCHES=100, annealing_factor=1.0, dataset='flowers', dist_backend='gloo', dist_url='tcp://224.66.41.62:23456', embedding_size=256, eval_epoch=3, eval_step=1000, evaluate_only=False, evaluate_train=False, experiment_name='Test', log_rate=10, loss='magnet', lr=0.024, model='inception', momentum=0.9, num_epochs=100, optimizer='sgd', resume=None, save_epoch=10, weight_decay=0.0001, workers=7, world_size=1)

Experiment path is :  /z/home/mbanani/projects/pytorch-magnet-loss/experiments/flowers/exp_04_17_13_55_39_flowers_Test
#############  Read in Database   ##############
Generating Datasets
csv file length:  1019
Dataset loaded in  0.038694143295288086  secs.
Dataset size:  1019
csv file length:  1019
Dataset loaded in  0.015230417251586914  secs.
Dataset size:  1019
Generating Data Loaders
Time taken:  0.054567575454711914 seconds
######## Initiate Model and Optimizer   ##############
Time taken:  8.91857099533081 seconds
#############  Start Training     ##############
KNN: Forward Pass Time   12.197
KNN: Clustering time     0.631
Number of proper clusters: 102
Epoch: [0][10/16]	Time 0.650 (0.749)	Data 0.000 (0.082)	Loss 4.3918 (4.4159)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.544)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.521)
Test: 	Time 0.527	Prec@1 27.604	Prec@5 53.646
KNN: Forward Pass Time   3.027
KNN: Clustering time     0.095
Number of proper clusters: 102
/z/home/mbanani/PyTorch3/lib/python3.5/site-packages/sklearn/cluster/k_means_.py:896: RuntimeWarning: Explicit initial center position passed: performing only one init in k-means instead of n_init=10
  return_n_iter=True)
Epoch: [1][10/16]	Time 0.674 (0.737)	Data 0.000 (0.089)	Loss 4.4166 (4.4151)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.546)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.672)
Test: 	Time 0.679	Prec@1 65.495	Prec@5 84.766
KNN: Forward Pass Time   3.106
KNN: Clustering time     0.114
Number of proper clusters: 102
Epoch: [2][10/16]	Time 0.722 (0.732)	Data 0.000 (0.069)	Loss 4.4180 (4.4121)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.642)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.580)
Test: 	Time 0.587	Prec@1 66.016	Prec@5 85.807
KNN: Forward Pass Time   3.073
KNN: Clustering time     0.144
Number of proper clusters: 102
Epoch: [3][10/16]	Time 0.640 (0.736)	Data 0.000 (0.092)	Loss 4.4080 (4.3883)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.583)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.573)
Test: 	Time 0.580	Prec@1 64.062	Prec@5 86.198
KNN: Forward Pass Time   3.162
KNN: Clustering time     0.082
Number of proper clusters: 102
Epoch: [4][10/16]	Time 0.724 (0.745)	Data 0.000 (0.067)	Loss 4.3383 (4.3846)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.660)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.682)
Test: 	Time 0.689	Prec@1 65.365	Prec@5 85.938
KNN: Forward Pass Time   3.010
KNN: Clustering time     0.098
Number of proper clusters: 102
Epoch: [5][10/16]	Time 0.682 (0.758)	Data 0.000 (0.081)	Loss 4.2990 (4.3650)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.656)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.585)
Test: 	Time 0.592	Prec@1 65.495	Prec@5 84.115
KNN: Forward Pass Time   2.994
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [6][10/16]	Time 0.651 (0.743)	Data 0.000 (0.072)	Loss 4.2610 (4.3183)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.544)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.463)
Test: 	Time 0.470	Prec@1 63.672	Prec@5 82.682
KNN: Forward Pass Time   3.223
KNN: Clustering time     0.157
Number of proper clusters: 102
Epoch: [7][10/16]	Time 0.659 (0.740)	Data 0.000 (0.070)	Loss 4.2822 (4.3148)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.716)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.655)
Test: 	Time 0.662	Prec@1 63.021	Prec@5 86.068
KNN: Forward Pass Time   3.284
KNN: Clustering time     0.148
Number of proper clusters: 102
train_magnet.py:444: RuntimeWarning: invalid value encountered in true_divide
  loss_vector = loss_vector / np.sum(loss_vector)
train_magnet.py:407: RuntimeWarning: invalid value encountered in less
  M0 = np.random.choice(range(0, num_clusters), p = loss_vector)
Epoch: [8][10/17]	Time 0.706 (0.757)	Data 0.000 (0.078)	Loss 4.1545 (4.2932)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.683)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.623)
Test: 	Time 0.630	Prec@1 62.623	Prec@5 83.946
KNN: Forward Pass Time   3.091
KNN: Clustering time     0.145
Number of proper clusters: 102
Epoch: [9][10/16]	Time 0.665 (0.733)	Data 0.000 (0.066)	Loss 4.1675 (4.2370)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.766)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.616)
Test: 	Time 0.623	Prec@1 54.688	Prec@5 82.161
KNN: Forward Pass Time   3.027
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [10][10/16]	Time 0.656 (0.738)	Data 0.000 (0.072)	Loss 4.0774 (4.2187)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.693)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.470)
Test: 	Time 0.476	Prec@1 58.724	Prec@5 82.552
KNN: Forward Pass Time   3.178
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [11][10/16]	Time 0.739 (0.742)	Data 0.000 (0.070)	Loss 4.3971 (4.1482)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.802)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.589)
Test: 	Time 0.596	Prec@1 55.339	Prec@5 80.469
KNN: Forward Pass Time   3.038
KNN: Clustering time     0.098
Number of proper clusters: 102
Epoch: [12][10/16]	Time 0.644 (0.737)	Data 0.000 (0.073)	Loss 4.3232 (4.1122)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.825)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.610)
Test: 	Time 0.617	Prec@1 52.344	Prec@5 80.078
KNN: Forward Pass Time   3.088
KNN: Clustering time     0.173
Number of proper clusters: 102
Epoch: [13][10/16]	Time 0.683 (0.780)	Data 0.000 (0.084)	Loss 3.7945 (4.0419)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.814)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.525)
Test: 	Time 0.531	Prec@1 50.521	Prec@5 76.693
KNN: Forward Pass Time   3.073
KNN: Clustering time     0.086
Number of proper clusters: 102
Epoch: [14][10/16]	Time 0.650 (0.757)	Data 0.000 (0.083)	Loss 3.6331 (4.0597)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.769)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.584)
Test: 	Time 0.591	Prec@1 50.391	Prec@5 76.953
KNN: Forward Pass Time   3.107
KNN: Clustering time     0.100
Number of proper clusters: 102
Epoch: [15][10/16]	Time 0.719 (0.764)	Data 0.000 (0.071)	Loss 4.0179 (4.0461)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.721)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.608)
Test: 	Time 0.615	Prec@1 51.562	Prec@5 78.906
KNN: Forward Pass Time   3.260
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [16][10/16]	Time 0.663 (0.774)	Data 0.000 (0.077)	Loss 3.9291 (3.8918)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.544)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.589)
Test: 	Time 0.596	Prec@1 48.958	Prec@5 78.125
KNN: Forward Pass Time   3.168
KNN: Clustering time     0.160
Number of proper clusters: 102
Epoch: [17][10/16]	Time 0.682 (0.764)	Data 0.000 (0.089)	Loss 3.6946 (3.9128)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.637)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.642)
Test: 	Time 0.649	Prec@1 43.490	Prec@5 73.438
KNN: Forward Pass Time   3.089
KNN: Clustering time     0.149
Number of proper clusters: 102
Epoch: [18][10/16]	Time 0.708 (0.799)	Data 0.000 (0.090)	Loss 3.8406 (3.9735)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.645)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.649)
Test: 	Time 0.656	Prec@1 48.828	Prec@5 76.823
KNN: Forward Pass Time   3.090
KNN: Clustering time     0.146
Number of proper clusters: 102
Epoch: [19][10/16]	Time 0.702 (0.793)	Data 0.000 (0.086)	Loss 3.9845 (3.8037)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.610)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.627)
Test: 	Time 0.634	Prec@1 47.266	Prec@5 78.776
KNN: Forward Pass Time   3.217
KNN: Clustering time     0.102
Number of proper clusters: 102
Epoch: [20][10/16]	Time 0.676 (0.746)	Data 0.000 (0.071)	Loss 3.8911 (3.8875)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.674)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.453)
Test: 	Time 0.459	Prec@1 43.750	Prec@5 78.776
KNN: Forward Pass Time   2.991
KNN: Clustering time     0.096
Number of proper clusters: 102
Epoch: [21][10/16]	Time 0.653 (0.742)	Data 0.000 (0.063)	Loss 3.8305 (3.7441)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.596)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.498)
Test: 	Time 0.504	Prec@1 48.698	Prec@5 76.432
KNN: Forward Pass Time   3.050
KNN: Clustering time     0.088
Number of proper clusters: 102
Epoch: [22][10/16]	Time 0.685 (0.735)	Data 0.000 (0.069)	Loss 3.8886 (3.7950)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.650)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.592)
Test: 	Time 0.599	Prec@1 45.964	Prec@5 80.078
KNN: Forward Pass Time   3.011
KNN: Clustering time     0.084
Number of proper clusters: 102
Epoch: [23][10/16]	Time 0.696 (0.777)	Data 0.000 (0.087)	Loss 2.9482 (3.7744)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.653)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.594)
Test: 	Time 0.601	Prec@1 47.396	Prec@5 78.125
KNN: Forward Pass Time   3.093
KNN: Clustering time     0.095
Number of proper clusters: 102
Epoch: [24][10/16]	Time 0.666 (0.745)	Data 0.000 (0.069)	Loss 3.5409 (3.5606)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.776)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.604)
Test: 	Time 0.611	Prec@1 47.786	Prec@5 79.557
KNN: Forward Pass Time   3.185
KNN: Clustering time     0.145
Number of proper clusters: 102
Epoch: [25][10/16]	Time 0.702 (0.746)	Data 0.000 (0.064)	Loss 3.5119 (3.6335)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.555)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.645)
Test: 	Time 0.652	Prec@1 41.406	Prec@5 78.125
KNN: Forward Pass Time   3.212
KNN: Clustering time     0.102
Number of proper clusters: 102
Epoch: [26][10/16]	Time 0.691 (0.784)	Data 0.000 (0.074)	Loss 3.7049 (3.6047)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.665)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.697)
Test: 	Time 0.704	Prec@1 36.328	Prec@5 71.615
KNN: Forward Pass Time   3.114
KNN: Clustering time     0.092
Number of proper clusters: 102
Epoch: [27][10/16]	Time 0.676 (0.741)	Data 0.000 (0.067)	Loss 3.6860 (3.5052)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.589)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.619)
Test: 	Time 0.626	Prec@1 48.698	Prec@5 80.729
KNN: Forward Pass Time   3.013
KNN: Clustering time     0.084
Number of proper clusters: 102
Epoch: [28][10/17]	Time 0.698 (0.775)	Data 0.000 (0.074)	Loss 3.2614 (3.5656)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.671)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.682)
Test: 	Time 0.689	Prec@1 45.711	Prec@5 77.328
KNN: Forward Pass Time   3.090
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [29][10/16]	Time 0.675 (0.767)	Data 0.000 (0.078)	Loss 3.6470 (3.4179)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.590)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.681)
Test: 	Time 0.688	Prec@1 41.927	Prec@5 80.339
KNN: Forward Pass Time   3.161
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [30][10/17]	Time 0.699 (0.786)	Data 0.000 (0.075)	Loss 3.7006 (3.3838)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.802)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.570)
Test: 	Time 0.576	Prec@1 40.441	Prec@5 73.652
KNN: Forward Pass Time   3.131
KNN: Clustering time     0.151
Number of proper clusters: 102
Epoch: [31][10/16]	Time 0.639 (0.753)	Data 0.000 (0.081)	Loss 3.4785 (3.2692)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.714)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.708)
Test: 	Time 0.715	Prec@1 29.948	Prec@5 70.312
KNN: Forward Pass Time   3.068
KNN: Clustering time     0.147
Number of proper clusters: 102
Epoch: [32][10/16]	Time 0.649 (0.766)	Data 0.000 (0.076)	Loss 3.5630 (3.3463)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.663)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.586)
Test: 	Time 0.593	Prec@1 39.453	Prec@5 73.047
KNN: Forward Pass Time   3.080
KNN: Clustering time     0.115
Number of proper clusters: 102
Epoch: [33][10/17]	Time 0.635 (0.737)	Data 0.000 (0.069)	Loss 2.9335 (3.5439)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.824)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.554)
Test: 	Time 0.560	Prec@1 44.118	Prec@5 79.657
KNN: Forward Pass Time   2.947
KNN: Clustering time     0.088
Number of proper clusters: 102
Epoch: [34][10/16]	Time 0.682 (0.740)	Data 0.000 (0.069)	Loss 1.7200 (3.0567)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.650)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.520)
Test: 	Time 0.526	Prec@1 43.880	Prec@5 79.167
KNN: Forward Pass Time   3.171
KNN: Clustering time     0.085
Number of proper clusters: 102
Epoch: [35][10/16]	Time 0.741 (0.777)	Data 0.000 (0.073)	Loss 2.6239 (3.2823)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.663)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.478)
Test: 	Time 0.484	Prec@1 43.359	Prec@5 76.432
KNN: Forward Pass Time   3.220
KNN: Clustering time     0.095
Number of proper clusters: 102
Epoch: [36][10/16]	Time 0.665 (0.766)	Data 0.000 (0.071)	Loss 2.1862 (3.2600)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.589)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.585)
Test: 	Time 0.592	Prec@1 49.089	Prec@5 82.031
KNN: Forward Pass Time   3.021
KNN: Clustering time     0.080
Number of proper clusters: 102
Epoch: [37][10/16]	Time 0.649 (0.751)	Data 0.000 (0.075)	Loss 2.9167 (3.3644)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.738)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.591)
Test: 	Time 0.598	Prec@1 57.422	Prec@5 86.328
KNN: Forward Pass Time   3.143
KNN: Clustering time     0.172
Number of proper clusters: 102
Epoch: [38][10/16]	Time 0.698 (0.761)	Data 0.000 (0.068)	Loss 3.1330 (3.1046)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.669)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.569)
Test: 	Time 0.582	Prec@1 49.609	Prec@5 82.812
KNN: Forward Pass Time   3.084
KNN: Clustering time     0.086
Number of proper clusters: 102
Epoch: [39][10/16]	Time 0.648 (0.746)	Data 0.000 (0.070)	Loss 2.8357 (3.0488)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.632)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.572)
Test: 	Time 0.585	Prec@1 43.620	Prec@5 80.859
KNN: Forward Pass Time   3.178
KNN: Clustering time     0.139
Number of proper clusters: 102
Epoch: [40][10/16]	Time 0.684 (0.750)	Data 0.000 (0.073)	Loss 2.4136 (3.0042)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.641)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.527)
Test: 	Time 0.533	Prec@1 49.609	Prec@5 84.635
KNN: Forward Pass Time   3.135
KNN: Clustering time     0.084
Number of proper clusters: 102
Epoch: [41][10/16]	Time 0.745 (0.766)	Data 0.000 (0.075)	Loss 2.7613 (3.0254)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.637)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.604)
Test: 	Time 0.611	Prec@1 50.391	Prec@5 81.120
KNN: Forward Pass Time   3.178
KNN: Clustering time     0.176
Number of proper clusters: 102
Epoch: [42][10/16]	Time 0.694 (0.772)	Data 0.000 (0.077)	Loss 2.1212 (3.1412)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.765)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.660)
Test: 	Time 0.667	Prec@1 47.266	Prec@5 76.562
KNN: Forward Pass Time   3.259
KNN: Clustering time     0.149
Number of proper clusters: 102
Epoch: [43][10/16]	Time 0.684 (0.765)	Data 0.000 (0.077)	Loss 2.0381 (3.0424)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.620)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.461)
Test: 	Time 0.467	Prec@1 50.130	Prec@5 82.552
KNN: Forward Pass Time   2.999
KNN: Clustering time     0.145
Number of proper clusters: 102
Epoch: [44][10/16]	Time 0.687 (0.762)	Data 0.000 (0.070)	Loss 3.2653 (3.2152)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.603)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.586)
Test: 	Time 0.594	Prec@1 47.656	Prec@5 79.818
KNN: Forward Pass Time   3.081
KNN: Clustering time     0.145
Number of proper clusters: 102
Epoch: [45][10/16]	Time 0.656 (0.733)	Data 0.000 (0.072)	Loss 2.9783 (2.9720)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.653)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.580)
Test: 	Time 0.587	Prec@1 57.292	Prec@5 85.677
KNN: Forward Pass Time   3.075
KNN: Clustering time     0.088
Number of proper clusters: 102
Epoch: [46][10/16]	Time 0.691 (0.772)	Data 0.000 (0.072)	Loss 2.7868 (2.9631)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.644)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.680)
Test: 	Time 0.687	Prec@1 54.036	Prec@5 83.854
KNN: Forward Pass Time   3.091
KNN: Clustering time     0.148
Number of proper clusters: 102
Epoch: [47][10/17]	Time 0.673 (0.730)	Data 0.000 (0.068)	Loss 2.3787 (2.9484)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.719)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.550)
Test: 	Time 0.556	Prec@1 46.691	Prec@5 81.005
KNN: Forward Pass Time   3.127
KNN: Clustering time     0.118
Number of proper clusters: 102
Epoch: [48][10/16]	Time 0.638 (0.763)	Data 0.000 (0.078)	Loss 3.5149 (2.9485)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.728)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.526)
Test: 	Time 0.532	Prec@1 52.344	Prec@5 84.896
KNN: Forward Pass Time   3.007
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [49][10/16]	Time 0.664 (0.749)	Data 0.000 (0.078)	Loss 2.3823 (2.8134)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.744)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.467)
Test: 	Time 0.473	Prec@1 41.667	Prec@5 79.036
KNN: Forward Pass Time   3.097
KNN: Clustering time     0.154
Number of proper clusters: 102
Epoch: [50][10/16]	Time 0.682 (0.758)	Data 0.000 (0.080)	Loss 2.5089 (3.1248)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.732)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.530)
Test: 	Time 0.537	Prec@1 48.828	Prec@5 82.161
KNN: Forward Pass Time   3.015
KNN: Clustering time     0.142
Number of proper clusters: 102
Epoch: [51][10/16]	Time 0.683 (0.744)	Data 0.000 (0.075)	Loss 2.9389 (2.8682)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.689)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.539)
Test: 	Time 0.546	Prec@1 49.870	Prec@5 81.120
KNN: Forward Pass Time   3.120
KNN: Clustering time     0.149
Number of proper clusters: 102
Epoch: [52][10/17]	Time 0.698 (0.758)	Data 0.000 (0.072)	Loss 3.3705 (2.7642)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.849)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.647)
Test: 	Time 0.655	Prec@1 45.098	Prec@5 79.657
KNN: Forward Pass Time   3.018
KNN: Clustering time     0.145
Number of proper clusters: 102
Epoch: [53][10/16]	Time 0.683 (0.783)	Data 0.000 (0.083)	Loss 3.2156 (2.7804)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.634)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.522)
Test: 	Time 0.528	Prec@1 47.786	Prec@5 80.208
KNN: Forward Pass Time   3.137
KNN: Clustering time     0.137
Number of proper clusters: 102
Epoch: [54][10/16]	Time 0.680 (0.747)	Data 0.000 (0.081)	Loss 2.3078 (2.7990)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.638)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.453)
Test: 	Time 0.460	Prec@1 44.271	Prec@5 73.568
KNN: Forward Pass Time   3.189
KNN: Clustering time     0.087
Number of proper clusters: 102
Epoch: [55][10/16]	Time 0.701 (0.764)	Data 0.000 (0.070)	Loss 2.2354 (2.9475)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.706)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.598)
Test: 	Time 0.605	Prec@1 48.568	Prec@5 84.375
KNN: Forward Pass Time   3.161
KNN: Clustering time     0.084
Number of proper clusters: 102
Epoch: [56][10/16]	Time 0.676 (0.749)	Data 0.000 (0.077)	Loss 2.0970 (2.7420)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.763)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.607)
Test: 	Time 0.614	Prec@1 49.740	Prec@5 82.812
KNN: Forward Pass Time   3.166
KNN: Clustering time     0.099
Number of proper clusters: 102
Epoch: [57][10/16]	Time 0.687 (0.773)	Data 0.000 (0.070)	Loss 1.5025 (2.7165)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.683)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.601)
Test: 	Time 0.608	Prec@1 55.859	Prec@5 84.896
KNN: Forward Pass Time   3.120
KNN: Clustering time     0.079
Number of proper clusters: 102
Epoch: [58][10/16]	Time 0.698 (0.759)	Data 0.000 (0.062)	Loss 2.5116 (3.0155)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.805)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.599)
Test: 	Time 0.606	Prec@1 50.911	Prec@5 81.510
KNN: Forward Pass Time   3.008
KNN: Clustering time     0.086
Number of proper clusters: 102
Epoch: [59][10/16]	Time 0.658 (0.753)	Data 0.000 (0.086)	Loss 1.3563 (2.5217)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.678)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.581)
Test: 	Time 0.588	Prec@1 53.776	Prec@5 85.156
KNN: Forward Pass Time   2.987
KNN: Clustering time     0.090
Number of proper clusters: 102
Epoch: [60][10/16]	Time 0.679 (0.755)	Data 0.000 (0.070)	Loss 2.7853 (2.6287)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.782)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.630)
Test: 	Time 0.637	Prec@1 49.219	Prec@5 81.641
KNN: Forward Pass Time   3.088
KNN: Clustering time     0.090
Number of proper clusters: 102
Epoch: [61][10/16]	Time 0.651 (0.740)	Data 0.000 (0.067)	Loss 1.7284 (2.5573)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.699)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.502)
Test: 	Time 0.508	Prec@1 45.703	Prec@5 79.167
KNN: Forward Pass Time   3.260
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [62][10/16]	Time 0.704 (0.773)	Data 0.000 (0.072)	Loss 2.7757 (3.0300)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.705)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.585)
Test: 	Time 0.599	Prec@1 41.927	Prec@5 79.948
KNN: Forward Pass Time   3.221
KNN: Clustering time     0.097
Number of proper clusters: 102
Epoch: [63][10/16]	Time 0.639 (0.731)	Data 0.000 (0.070)	Loss 3.1882 (2.5587)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.823)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.564)
Test: 	Time 0.577	Prec@1 50.521	Prec@5 82.682
KNN: Forward Pass Time   3.156
KNN: Clustering time     0.093
Number of proper clusters: 102
Epoch: [64][10/16]	Time 0.666 (0.767)	Data 0.000 (0.080)	Loss 1.8367 (2.7546)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.705)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.455)
Test: 	Time 0.461	Prec@1 51.953	Prec@5 86.458
KNN: Forward Pass Time   3.218
KNN: Clustering time     0.107
Number of proper clusters: 102
Epoch: [65][10/17]	Time 0.677 (0.775)	Data 0.000 (0.086)	Loss 3.2608 (2.5508)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.611)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.484)
Test: 	Time 0.491	Prec@1 49.387	Prec@5 83.701
KNN: Forward Pass Time   3.240
KNN: Clustering time     0.099
Number of proper clusters: 102
Epoch: [66][10/16]	Time 0.662 (0.757)	Data 0.000 (0.070)	Loss 2.5248 (2.5211)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.696)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.605)
Test: 	Time 0.612	Prec@1 55.990	Prec@5 87.500
KNN: Forward Pass Time   3.214
KNN: Clustering time     0.088
Number of proper clusters: 102
Epoch: [67][10/16]	Time 0.658 (0.755)	Data 0.000 (0.079)	Loss 2.5903 (2.7581)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.723)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.592)
Test: 	Time 0.599	Prec@1 55.729	Prec@5 83.464
KNN: Forward Pass Time   3.143
KNN: Clustering time     0.149
Number of proper clusters: 102
Epoch: [68][10/16]	Time 0.659 (0.747)	Data 0.000 (0.069)	Loss 1.5432 (2.5858)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.659)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.596)
Test: 	Time 0.603	Prec@1 55.469	Prec@5 85.026
KNN: Forward Pass Time   3.047
KNN: Clustering time     0.144
Number of proper clusters: 102
Epoch: [69][10/16]	Time 0.719 (0.789)	Data 0.000 (0.078)	Loss 2.5432 (2.7691)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.569)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.455)
Test: 	Time 0.461	Prec@1 47.786	Prec@5 82.943
KNN: Forward Pass Time   3.160
KNN: Clustering time     0.083
Number of proper clusters: 102
Epoch: [70][10/16]	Time 0.636 (0.722)	Data 0.000 (0.068)	Loss 3.2113 (2.4453)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.708)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.582)
Test: 	Time 0.589	Prec@1 57.943	Prec@5 87.630
KNN: Forward Pass Time   3.022
KNN: Clustering time     0.095
Number of proper clusters: 102
Epoch: [71][10/16]	Time 0.669 (0.759)	Data 0.000 (0.079)	Loss 1.2336 (2.5602)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.673)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.529)
Test: 	Time 0.535	Prec@1 39.844	Prec@5 73.958
KNN: Forward Pass Time   3.173
KNN: Clustering time     0.145
Number of proper clusters: 102
Epoch: [72][10/16]	Time 0.657 (0.758)	Data 0.000 (0.077)	Loss 1.8087 (2.5253)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.589)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.579)
Test: 	Time 0.586	Prec@1 33.594	Prec@5 71.354
KNN: Forward Pass Time   3.120
KNN: Clustering time     0.154
Number of proper clusters: 102
Epoch: [73][10/16]	Time 0.686 (0.777)	Data 0.000 (0.072)	Loss 1.7767 (2.2487)	
Evaluation: Forward Embedding Calculation (Time Elapsed 2.598)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.464)
Test: 	Time 0.470	Prec@1 55.729	Prec@5 86.849
KNN: Forward Pass Time   3.207
KNN: Clustering time     0.153
Number of proper clusters: 102
Epoch: [74][10/17]	Time 0.666 (0.747)	Data 0.000 (0.082)	Loss 1.9789 (2.5168)	
train_magnet.py:197: RuntimeWarning: overflow encountered in add
  loss_count  += c_loss_count
Evaluation: Forward Embedding Calculation (Time Elapsed 2.897)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.545)
Test: 	Time 0.551	Prec@1 62.990	Prec@5 90.319
KNN: Forward Pass Time   3.073
KNN: Clustering time     0.149
Number of proper clusters: 102
train_magnet.py:398: RuntimeWarning: invalid value encountered in true_divide
  loss_vector = loss_vector / sum(loss_vector)
Evaluation: Forward Embedding Calculation (Time Elapsed 1.042)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.058)
Test: 	Time 0.059	Prec@1 70.833	Prec@5 92.708
KNN: Forward Pass Time   3.123
KNN: Clustering time     0.094
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.092)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.059)
Test: 	Time 0.060	Prec@1 55.208	Prec@5 89.583
KNN: Forward Pass Time   3.226
KNN: Clustering time     0.111
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.033)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.061)
Test: 	Time 0.062	Prec@1 62.500	Prec@5 85.417
KNN: Forward Pass Time   3.142
KNN: Clustering time     0.102
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 0.964)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.073)
Test: 	Time 0.074	Prec@1 60.417	Prec@5 88.542
KNN: Forward Pass Time   3.067
KNN: Clustering time     0.143
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.215)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.079)
Test: 	Time 0.080	Prec@1 60.417	Prec@5 93.750
KNN: Forward Pass Time   3.284
KNN: Clustering time     0.148
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.033)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.098)
Test: 	Time 0.100	Prec@1 72.917	Prec@5 94.792
KNN: Forward Pass Time   3.171
KNN: Clustering time     0.096
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 0.984)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.060)
Test: 	Time 0.061	Prec@1 69.792	Prec@5 93.750
KNN: Forward Pass Time   3.157
KNN: Clustering time     0.095
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.077)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.111)
Test: 	Time 0.113	Prec@1 59.375	Prec@5 85.417
KNN: Forward Pass Time   3.197
KNN: Clustering time     0.097
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.073)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.067)
Test: 	Time 0.067	Prec@1 63.542	Prec@5 96.875
KNN: Forward Pass Time   3.220
KNN: Clustering time     0.145
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.069)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.064)
Test: 	Time 0.065	Prec@1 76.042	Prec@5 93.750
KNN: Forward Pass Time   3.170
KNN: Clustering time     0.148
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 0.983)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.060)
Test: 	Time 0.061	Prec@1 66.667	Prec@5 96.875
KNN: Forward Pass Time   3.168
KNN: Clustering time     0.100
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.075)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.075)
Test: 	Time 0.076	Prec@1 70.833	Prec@5 95.833
KNN: Forward Pass Time   3.197
KNN: Clustering time     0.142
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.147)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.068)
Test: 	Time 0.069	Prec@1 67.708	Prec@5 90.625
KNN: Forward Pass Time   3.212
KNN: Clustering time     0.101
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.183)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.064)
Test: 	Time 0.065	Prec@1 62.500	Prec@5 87.500
KNN: Forward Pass Time   3.140
KNN: Clustering time     0.089
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.043)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.059)
Test: 	Time 0.060	Prec@1 70.833	Prec@5 92.708
KNN: Forward Pass Time   2.949
KNN: Clustering time     0.143
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.073)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.083)
Test: 	Time 0.084	Prec@1 65.625	Prec@5 90.625
KNN: Forward Pass Time   3.215
KNN: Clustering time     0.152
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.100)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.105)
Test: 	Time 0.106	Prec@1 65.625	Prec@5 95.833
KNN: Forward Pass Time   3.040
KNN: Clustering time     0.093
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 0.993)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.077)
Test: 	Time 0.078	Prec@1 68.750	Prec@5 87.500
KNN: Forward Pass Time   3.230
KNN: Clustering time     0.122
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.091)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.062)
Test: 	Time 0.063	Prec@1 84.375	Prec@5 95.833
KNN: Forward Pass Time   3.030
KNN: Clustering time     0.154
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.088)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.056)
Test: 	Time 0.056	Prec@1 84.375	Prec@5 96.875
KNN: Forward Pass Time   3.289
KNN: Clustering time     0.116
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.166)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.075)
Test: 	Time 0.076	Prec@1 81.250	Prec@5 92.708
KNN: Forward Pass Time   3.169
KNN: Clustering time     0.103
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.015)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.060)
Test: 	Time 0.061	Prec@1 75.000	Prec@5 91.667
KNN: Forward Pass Time   3.239
KNN: Clustering time     0.133
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.128)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.077)
Test: 	Time 0.078	Prec@1 71.875	Prec@5 91.667
KNN: Forward Pass Time   3.190
KNN: Clustering time     0.087
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.142)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.123)
Test: 	Time 0.125	Prec@1 66.667	Prec@5 86.458
KNN: Forward Pass Time   3.163
KNN: Clustering time     0.097
Number of proper clusters: 102
Evaluation: Forward Embedding Calculation (Time Elapsed 1.104)
Evaluation: Softmax Probability Calculation (Time Elapsed 0.078)
Test: 	Time 0.079	Prec@1 64.583	Prec@5 84.375
KNN: Forward Pass Time   3.305
KNN: Clustering time     0.086
Done
